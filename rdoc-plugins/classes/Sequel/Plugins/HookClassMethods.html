<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang='en'>
  <head>
    <title>Sequel::Plugins::HookClassMethods</title>
    <meta content='text/html; charset=UTF-8' http-equiv='Content-Type'>
    <link href='../../../css/style.css' media='screen' rel='stylesheet' type='text/css'>
    <script type='text/javascript'>
      //<![CDATA[
        function popupCode(url) {
          window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
        }
        
        function toggleCode(id) {
          var code = document.getElementById(id)
        
          code.style.display = code.style.display != 'block' ? 'block' : 'none'
          return true
        }
        
        // Make codeblocks hidden by default
        document.writeln('<' + 'style type="text/css">.method .source pre { display: none }<\/style>')
      //]]>
    </script>
  </head>
  <body class='page'>
    <div class='class' id='wrapper'>
      <div class='header'>
        <h1 class='name'>
          <span class='type'>module</span>
          Sequel::Plugins::HookClassMethods
        </h1>
        <ol class='paths'>
          <li>
            <a target="docwin" href="../../../files/lib/sequel/plugins/hook_class_methods_rb.html">lib/sequel/plugins/hook_class_methods.rb</a>
          </li>
        </ol>
        <div class='parent'>
          Parent:
          <strong><a target="docwin" href="../Plugins.html">Plugins</a></strong>
        </div>
      </div>
      <div id='content'>
        <div id='text'>
          <div id='description'>
            
            <p>Sequelâ€™s built-in hook class methods plugin is designed for backwards
            compatibility.  Its use is not encouraged, it is recommended to use
            instance methods and super instead of this plugin.  What this plugin allows
            you to do is, for example:</p>
            
            <pre># Block only, can cause duplicate hooks if code is reloaded&#x000A;before_save{self.created_at = Time.now}&#x000A;# Block with tag, safe for reloading&#x000A;before_save(:set_created_at){self.created_at = Time.now}&#x000A;# Tag only, safe for reloading, calls instance method&#x000A;before_save(:set_created_at)</pre>
            
            <p>Pretty much anything you can do with a hook class method, you can also do
            with an instance method instead:</p>
            
            <pre class="ruby"><span class="ruby-keyword">def</span> <span class="ruby-identifier">before_save</span>&#x000A;  <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">super</span> <span class="ruby-operator">==</span> <span class="ruby-keyword">false</span>&#x000A;  <span class="ruby-keyword">self</span>.<span class="ruby-identifier">created_at</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>&#x000A;<span class="ruby-keyword">end</span></pre>
            
            <p>Note that returning false in any before hook block will skip further before
            hooks and abort the action.  So if a before_save hook block returns false,
            future before_save hook blocks are not called, and the save is aborted.</p>
            
            <p>Usage:</p>
            
            <pre class="ruby"><span class="ruby-comment"># Allow use of hook class methods in all model subclasses (called before loading subclasses)</span>&#x000A;<span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">Model</span>.<span class="ruby-identifier">plugin</span> :<span class="ruby-identifier">hook_class_methods</span>&#x000A;&#x000A;<span class="ruby-comment"># Allow the use of hook class methods in the Album class</span>&#x000A;<span class="ruby-constant">Album</span>.<span class="ruby-identifier">plugin</span> :<span class="ruby-identifier">hook_class_methods</span></pre>
          </div>
          <div id='method-list'>
            <h2>Methods</h2>
            <h3>Public Class</h3>
            <ol>
              <li><a target="docwin" href="#method-c-apply">apply</a></li>
            </ol>
          </div>
          <div id='context'>
          </div>
          <div id='class-list'>
            <h2>Classes and Modules</h2>
            <ol>
              <li><a target="docwin" href="HookClassMethods/ClassMethods.html">Sequel::Plugins::HookClassMethods::ClassMethods</a></li>
              <li><a target="docwin" href="HookClassMethods/InstanceMethods.html">Sequel::Plugins::HookClassMethods::InstanceMethods</a></li>
            </ol>
          </div>
          <div id='section'>
            <div id='methods'>
              <h2>Public Class methods</h2>
              <div class='method public-class' id='method-method-c-apply'>
                <a name='method-c-apply'></a>
                <div class='synopsis'>
                  <span class='name'>apply</span>
                  <span class='arguments'>(model)</span>
                </div>
                <div class='description'>
                  
                  <p>Set up the hooks instance variable in the model.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-c-apply-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-c-apply-source'><span class="ruby-comment"># File lib/sequel/plugins/hook_class_methods.rb, line 36</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier">apply</span>(<span class="ruby-identifier">model</span>)&#x000A;  <span class="ruby-identifier">hooks</span> = <span class="ruby-identifier">model</span>.<span class="ruby-identifier">instance_variable_set</span>(<span class="ruby-value">:@hooks</span>, {})&#x000A;  <span class="ruby-constant">Model</span><span class="ruby-operator">::</span><span class="ruby-constant">HOOKS</span>.<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">h</span><span class="ruby-operator">|</span> <span class="ruby-identifier">hooks</span>[<span class="ruby-identifier">h</span>] = []}&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div id='footer-push'></div>
    </div>
    <div id='footer'>
      <a target="docwin" href="http://github.com/mislav/hanna/tree/master"><strong>Hanna</strong> RDoc template</a>
    </div>
  </body>
</html>
