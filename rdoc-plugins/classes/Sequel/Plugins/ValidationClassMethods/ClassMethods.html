<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang='en'>
  <head>
    <title>Sequel::Plugins::ValidationClassMethods::ClassMethods</title>
    <meta content='text/html; charset=UTF-8' http-equiv='Content-Type'>
    <link href='../../../../css/style.css' media='screen' rel='stylesheet' type='text/css'>
    <script type='text/javascript'>
      //<![CDATA[
        function popupCode(url) {
          window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
        }
        
        function toggleCode(id) {
          var code = document.getElementById(id)
        
          code.style.display = code.style.display != 'block' ? 'block' : 'none'
          return true
        }
        
        // Make codeblocks hidden by default
        document.writeln('<' + 'style type="text/css">.method .source pre { display: none }<\/style>')
      //]]>
    </script>
  </head>
  <body class='page'>
    <div class='class' id='wrapper'>
      <div class='header'>
        <h1 class='name'>
          <span class='type'>module</span>
          Sequel::Plugins::ValidationClassMethods::ClassMethods
        </h1>
        <ol class='paths'>
          <li>
            <a target="docwin" href="../../../../files/lib/sequel/plugins/validation_class_methods_rb.html">lib/sequel/plugins/validation_class_methods.rb</a>
          </li>
        </ol>
        <div class='parent'>
          Parent:
          <strong><a target="docwin" href="../ValidationClassMethods.html">ValidationClassMethods</a></strong>
        </div>
      </div>
      <div id='content'>
        <div id='text'>
          <div id='description'></div>
          <div id='method-list'>
            <h2>Methods</h2>
            <h3>Public Instance</h3>
            <ol>
              <li><a target="docwin" href="#method-i-has_validations-3F">has_validations?</a></li>
              <li><a target="docwin" href="#method-i-skip_superclass_validations">skip_superclass_validations</a></li>
              <li><a target="docwin" href="#method-i-skip_superclass_validations-3F">skip_superclass_validations?</a></li>
              <li><a target="docwin" href="#method-i-validate">validate</a></li>
              <li><a target="docwin" href="#method-i-validates">validates</a></li>
              <li><a target="docwin" href="#method-i-validates_acceptance_of">validates_acceptance_of</a></li>
              <li><a target="docwin" href="#method-i-validates_confirmation_of">validates_confirmation_of</a></li>
              <li><a target="docwin" href="#method-i-validates_each">validates_each</a></li>
              <li><a target="docwin" href="#method-i-validates_format_of">validates_format_of</a></li>
              <li><a target="docwin" href="#method-i-validates_inclusion_of">validates_inclusion_of</a></li>
              <li><a target="docwin" href="#method-i-validates_length_of">validates_length_of</a></li>
              <li><a target="docwin" href="#method-i-validates_numericality_of">validates_numericality_of</a></li>
              <li><a target="docwin" href="#method-i-validates_presence_of">validates_presence_of</a></li>
              <li><a target="docwin" href="#method-i-validates_schema_type">validates_schema_type</a></li>
              <li><a target="docwin" href="#method-i-validates_uniqueness_of">validates_uniqueness_of</a></li>
              <li><a target="docwin" href="#attribute-i-validation_reflections">validation_reflections</a></li>
              <li><a target="docwin" href="#attribute-i-validations">validations</a></li>
            </ol>
          </div>
          <div id='context'>
          </div>
          <div id='class-list'>
            <h2>Classes and Modules</h2>
            <ol>
              <li><a target="docwin" href="ClassMethods/Generator.html">Sequel::Plugins::ValidationClassMethods::ClassMethods::Generator</a></li>
            </ol>
          </div>
          <div id='section'>
            <div id='attribute-list'>
              <h2 class='section-bar'>Attributes</h2>
              <div class='name-list'>
                <table>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>
                      <a name='attribute-i-validation_reflections'>validation_reflections</a>
                    </td>
                    <td class='context-item-value'>[R]</td>
                    <td class='context-item-desc'>
                      
                      <p>A hash of validation reflections for this model class.  Keys are column
                      symbols, values are an array of two element arrays, with the first element
                      being the validation type symbol and the second being a hash of validation
                      options.</p>
                    </td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>
                      <a name='attribute-i-validations'>validations</a>
                    </td>
                    <td class='context-item-value'>[R]</td>
                    <td class='context-item-desc'>
                      
                      <p>A hash of validations for this model class.  Keys are column symbols,
                      values are arrays of validation procs.</p>
                    </td>
                  </tr>
                </table>
              </div>
            </div>
            <div id='methods'>
              <h2>Public Instance methods</h2>
              <div class='method public-instance' id='method-method-i-has_validations-3F'>
                <a name='method-i-has_validations-3F'></a>
                <div class='synopsis'>
                  <span class='name'>has_validations?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Returns true if validations are defined.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-has_validations-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-has_validations-3F-source'><span class="ruby-comment"># File lib/sequel/plugins/validation_class_methods.rb, line 61</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">has_validations?</span>&#x000A;  <span class="ruby-operator">!</span><span class="ruby-identifier">validations</span>.<span class="ruby-identifier">empty?</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-skip_superclass_validations'>
                <a name='method-i-skip_superclass_validations'></a>
                <div class='synopsis'>
                  <span class='name'>skip_superclass_validations</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Instructs the model to skip validations defined in superclasses</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-skip_superclass_validations-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-skip_superclass_validations-source'><span class="ruby-comment"># File lib/sequel/plugins/validation_class_methods.rb, line 68</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">skip_superclass_validations</span>&#x000A;  <span class="ruby-identifier">superclass</span>.<span class="ruby-identifier">validations</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">att</span>, <span class="ruby-identifier">procs</span><span class="ruby-operator">|</span>&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-identifier">ps</span> = <span class="ruby-ivar">@validations</span>[<span class="ruby-identifier">att</span>]&#x000A;      <span class="ruby-ivar">@validations</span>[<span class="ruby-identifier">att</span>] <span class="ruby-operator">-=</span> <span class="ruby-identifier">procs</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-ivar">@skip_superclass_validations</span> = <span class="ruby-keyword">true</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-skip_superclass_validations-3F'>
                <a name='method-i-skip_superclass_validations-3F'></a>
                <div class='synopsis'>
                  <span class='name'>skip_superclass_validations?</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Instructs the model to skip validations defined in superclasses</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-skip_superclass_validations-3F-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-skip_superclass_validations-3F-source'><span class="ruby-comment"># File lib/sequel/plugins/validation_class_methods.rb, line 78</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">skip_superclass_validations?</span>&#x000A;  <span class="ruby-ivar">@skip_superclass_validations</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-validate'>
                <a name='method-i-validate'></a>
                <div class='synopsis'>
                  <span class='name'>validate</span>
                  <span class='arguments'>(o)</span>
                </div>
                <div class='description'>
                  
                  <p>Validates the given instance.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-validate-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-validate-source'><span class="ruby-comment"># File lib/sequel/plugins/validation_class_methods.rb, line 102</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">validate</span>(<span class="ruby-identifier">o</span>)&#x000A;  <span class="ruby-identifier">validations</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">att</span>, <span class="ruby-identifier">procs</span><span class="ruby-operator">|</span>&#x000A;    <span class="ruby-identifier">v</span> = <span class="ruby-keyword">case</span> <span class="ruby-identifier">att</span>&#x000A;    <span class="ruby-keyword">when</span> <span class="ruby-constant">Array</span>&#x000A;      <span class="ruby-identifier">att</span>.<span class="ruby-identifier">collect</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">a</span><span class="ruby-operator">|</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">a</span>)}&#x000A;    <span class="ruby-keyword">else</span>&#x000A;      <span class="ruby-identifier">o</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">att</span>)&#x000A;    <span class="ruby-keyword">end</span>&#x000A;    <span class="ruby-identifier">procs</span>.<span class="ruby-identifier">each</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">tag</span>, <span class="ruby-identifier">p</span><span class="ruby-operator">|</span> <span class="ruby-identifier">p</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">o</span>, <span class="ruby-identifier">att</span>, <span class="ruby-identifier">v</span>)}&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-validates'>
                <a name='method-i-validates'></a>
                <div class='synopsis'>
                  <span class='name'>validates</span>
                  <span class='arguments'>(&block)</span>
                </div>
                <div class='description'>
                  
                  <p>Defines validations by converting a longhand block into a series of 
                  shorthand definitions. For example:</p>
                  
                  <pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">MyClass</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">Model</span>&#x000A;  <span class="ruby-identifier">validates</span> <span class="ruby-keyword">do</span>&#x000A;    <span class="ruby-identifier">length_of</span> :<span class="ruby-identifier">name</span>, :<span class="ruby-identifier">minimum</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">6</span>&#x000A;    <span class="ruby-identifier">length_of</span> :<span class="ruby-identifier">password</span>, :<span class="ruby-identifier">minimum</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">8</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                  
                  <p>is equivalent to:</p>
                  
                  <pre class="ruby"><span class="ruby-keyword">class</span> <span class="ruby-constant">MyClass</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">Model</span>&#x000A;  <span class="ruby-identifier">validates_length_of</span> :<span class="ruby-identifier">name</span>, :<span class="ruby-identifier">minimum</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">6</span>&#x000A;  <span class="ruby-identifier">validates_length_of</span> :<span class="ruby-identifier">password</span>, :<span class="ruby-identifier">minimum</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">8</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-validates-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-validates-source'><span class="ruby-comment"># File lib/sequel/plugins/validation_class_methods.rb, line 97</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">validates</span>(&amp;<span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-constant">Generator</span>.<span class="ruby-identifier">new</span>(<span class="ruby-keyword">self</span>, &amp;<span class="ruby-identifier">block</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-validates_acceptance_of'>
                <a name='method-i-validates_acceptance_of'></a>
                <div class='synopsis'>
                  <span class='name'>validates_acceptance_of</span>
                  <span class='arguments'>(*atts)</span>
                </div>
                <div class='description'>
                  
                  <p>Validates acceptance of an attribute.  Just checks that the value is equal
                  to the :accept option. This method is unique in that :allow_nil is assumed
                  to be true instead of false.</p>
                  
                  <p>Possible Options:</p>
                  <ul><li>
                  <p>:accept - The value required for the object to be valid (default: ‘1’)</p>
                  </li><li>
                  <p>:message - The message to use (default: ‘is not accepted’)</p>
                  </li></ul>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-validates_acceptance_of-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-validates_acceptance_of-source'><span class="ruby-comment"># File lib/sequel/plugins/validation_class_methods.rb, line 121</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">validates_acceptance_of</span>(*<span class="ruby-identifier">atts</span>)&#x000A;  <span class="ruby-identifier">opts</span> = {&#x000A;    <span class="ruby-value">:message</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">'is not accepted'</span>,&#x000A;    <span class="ruby-value">:allow_nil</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword">true</span>,&#x000A;    <span class="ruby-value">:accept</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">'1'</span>,&#x000A;    <span class="ruby-value">:tag</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:acceptance</span>,&#x000A;  }.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">extract_options!</span>(<span class="ruby-identifier">atts</span>))&#x000A;  <span class="ruby-identifier">reflect_validation</span>(<span class="ruby-value">:acceptance</span>, <span class="ruby-identifier">opts</span>, <span class="ruby-identifier">atts</span>)&#x000A;  <span class="ruby-identifier">atts</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">opts</span>&#x000A;  <span class="ruby-identifier">validates_each</span>(*<span class="ruby-identifier">atts</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">o</span>, <span class="ruby-identifier">a</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span>&#x000A;    <span class="ruby-identifier">o</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add</span>(<span class="ruby-identifier">a</span>, <span class="ruby-identifier">opts</span>[<span class="ruby-value">:message</span>]) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">v</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:accept</span>]&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-validates_confirmation_of'>
                <a name='method-i-validates_confirmation_of'></a>
                <div class='synopsis'>
                  <span class='name'>validates_confirmation_of</span>
                  <span class='arguments'>(*atts)</span>
                </div>
                <div class='description'>
                  
                  <p>Validates confirmation of an attribute. Checks that the object has a
                  _confirmation value matching the current value.  For example:</p>
                  
                  <pre>validates_confirmation_of :blah</pre>
                  
                  <p>Just makes sure that object.blah = object.blah_confirmation.  Often used
                  for passwords or email addresses on web forms.</p>
                  
                  <p>Possible Options:</p>
                  <ul><li>
                  <p>:message - The message to use (default: ‘is not confirmed’)</p>
                  </li></ul>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-validates_confirmation_of-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-validates_confirmation_of-source'><span class="ruby-comment"># File lib/sequel/plugins/validation_class_methods.rb, line 145</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">validates_confirmation_of</span>(*<span class="ruby-identifier">atts</span>)&#x000A;  <span class="ruby-identifier">opts</span> = {&#x000A;    <span class="ruby-value">:message</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">'is not confirmed'</span>,&#x000A;    <span class="ruby-value">:tag</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:confirmation</span>,&#x000A;  }.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">extract_options!</span>(<span class="ruby-identifier">atts</span>))&#x000A;  <span class="ruby-identifier">reflect_validation</span>(<span class="ruby-value">:confirmation</span>, <span class="ruby-identifier">opts</span>, <span class="ruby-identifier">atts</span>)&#x000A;  <span class="ruby-identifier">atts</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">opts</span>&#x000A;  <span class="ruby-identifier">validates_each</span>(*<span class="ruby-identifier">atts</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">o</span>, <span class="ruby-identifier">a</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span>&#x000A;    <span class="ruby-identifier">o</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add</span>(<span class="ruby-identifier">a</span>, <span class="ruby-identifier">opts</span>[<span class="ruby-value">:message</span>]) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">v</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">send</span>(<span class="ruby-value">:&quot;#{a}_confirmation&quot;</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-validates_each'>
                <a name='method-i-validates_each'></a>
                <div class='synopsis'>
                  <span class='name'>validates_each</span>
                  <span class='arguments'>(*atts, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Adds a validation for each of the given attributes using the supplied
                  block. The block must accept three arguments: instance, attribute and 
                  value, e.g.:</p>
                  
                  <pre class="ruby"><span class="ruby-identifier">validates_each</span> :<span class="ruby-identifier">name</span>, :<span class="ruby-identifier">password</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">object</span>, <span class="ruby-identifier">attribute</span>, <span class="ruby-identifier">value</span><span class="ruby-operator">|</span>&#x000A;  <span class="ruby-identifier">object</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add</span>(<span class="ruby-identifier">attribute</span>, <span class="ruby-string">'is not nice'</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">nice?</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                  
                  <p>Possible Options:</p>
                  <ul><li>
                  <p>:allow_blank - Whether to skip the validation if the value is blank.</p>
                  </li><li>
                  <p>:allow_missing - Whether to skip the validation if the attribute isn’t a
                  key in the values hash.  This is different from allow_nil, because <a
                  href="../../../Sequel.html">Sequel</a> only sends the attributes in the
                  values when doing an insert or update.  If the attribute is not present, <a
                  href="../../../Sequel.html">Sequel</a> doesn’t specify it, so the database
                  will use the table’s default value.  This is different from having an
                  attribute in values with a value of nil, which <a
                  href="../../../Sequel.html">Sequel</a> will send as NULL. If your database
                  table has a non NULL default, this may be a good option to use.  You don’t
                  want to use allow_nil, because if the attribute is in values but has a
                  value nil, <a href="../../../Sequel.html">Sequel</a> will attempt to insert
                  a NULL value into the database, instead of using the database’s default.</p>
                  </li><li>
                  <p>:allow_nil - Whether to skip the validation if the value is nil.</p>
                  </li><li>
                  <p>:if - A symbol (indicating an instance_method) or proc (which is
                  instance_evaled) skipping this validation if it returns nil or false.</p>
                  </li><li>
                  <p>:tag - The tag to use for this validation.</p>
                  </li></ul>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-validates_each-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-validates_each-source'><span class="ruby-comment"># File lib/sequel/plugins/validation_class_methods.rb, line 180</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">validates_each</span>(*<span class="ruby-identifier">atts</span>, &amp;<span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-identifier">opts</span> = <span class="ruby-identifier">extract_options!</span>(<span class="ruby-identifier">atts</span>)&#x000A;  <span class="ruby-identifier">blk</span> = <span class="ruby-keyword">if</span> (<span class="ruby-identifier">i</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:if</span>]) <span class="ruby-operator">||</span> (<span class="ruby-identifier">am</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:allow_missing</span>]) <span class="ruby-operator">||</span> (<span class="ruby-identifier">an</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:allow_nil</span>]) <span class="ruby-operator">||</span> (<span class="ruby-identifier">ab</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:allow_blank</span>])&#x000A;    <span class="ruby-identifier">proc</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">o</span>,<span class="ruby-identifier">a</span>,<span class="ruby-identifier">v</span><span class="ruby-operator">|</span>&#x000A;      <span class="ruby-keyword">next</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">i</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">validation_if_proc</span>(<span class="ruby-identifier">o</span>, <span class="ruby-identifier">i</span>)&#x000A;      <span class="ruby-keyword">next</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">an</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-constant">Array</span>(<span class="ruby-identifier">v</span>).<span class="ruby-identifier">all?</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-identifier">x</span>.<span class="ruby-identifier">nil?</span>}&#x000A;      <span class="ruby-keyword">next</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">ab</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-constant">Array</span>(<span class="ruby-identifier">v</span>).<span class="ruby-identifier">all?</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-identifier">x</span>.<span class="ruby-identifier">blank?</span>}&#x000A;      <span class="ruby-keyword">next</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">am</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-constant">Array</span>(<span class="ruby-identifier">a</span>).<span class="ruby-identifier">all?</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-operator">!</span><span class="ruby-identifier">o</span>.<span class="ruby-identifier">values</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-identifier">x</span>)}&#x000A;      <span class="ruby-identifier">block</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">o</span>,<span class="ruby-identifier">a</span>,<span class="ruby-identifier">v</span>)&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">block</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-identifier">tag</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:tag</span>]&#x000A;  <span class="ruby-identifier">atts</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">a</span><span class="ruby-operator">|</span> &#x000A;    <span class="ruby-identifier">a_vals</span> = <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">synchronize</span>{<span class="ruby-identifier">validations</span>[<span class="ruby-identifier">a</span>] <span class="ruby-operator">||=</span> []}&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-identifier">tag</span> <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">old</span> = <span class="ruby-identifier">a_vals</span>.<span class="ruby-identifier">find</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-identifier">x</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">tag</span>})&#x000A;      <span class="ruby-identifier">old</span>[<span class="ruby-value">1</span>] = <span class="ruby-identifier">blk</span>&#x000A;    <span class="ruby-keyword">else</span>&#x000A;      <span class="ruby-identifier">a_vals</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-identifier">tag</span>, <span class="ruby-identifier">blk</span>]&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-validates_format_of'>
                <a name='method-i-validates_format_of'></a>
                <div class='synopsis'>
                  <span class='name'>validates_format_of</span>
                  <span class='arguments'>(*atts)</span>
                </div>
                <div class='description'>
                  
                  <p>Validates the format of an attribute, checking the string representation of
                  the value against the regular expression provided by the :with option.</p>
                  
                  <p>Possible Options:</p>
                  <ul><li>
                  <p>:message - The message to use (default: ‘is invalid’)</p>
                  </li><li>
                  <p>:with - The regular expression to validate the value with (required).</p>
                  </li></ul>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-validates_format_of-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-validates_format_of-source'><span class="ruby-comment"># File lib/sequel/plugins/validation_class_methods.rb, line 210</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">validates_format_of</span>(*<span class="ruby-identifier">atts</span>)&#x000A;  <span class="ruby-identifier">opts</span> = {&#x000A;    <span class="ruby-value">:message</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">'is invalid'</span>,&#x000A;    <span class="ruby-value">:tag</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:format</span>,&#x000A;  }.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">extract_options!</span>(<span class="ruby-identifier">atts</span>))&#x000A;  &#x000A;  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:with</span>].<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Regexp</span>)&#x000A;    <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-string">&quot;A regular expression must be supplied as the :with option of the options hash&quot;</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  &#x000A;  <span class="ruby-identifier">reflect_validation</span>(<span class="ruby-value">:format</span>, <span class="ruby-identifier">opts</span>, <span class="ruby-identifier">atts</span>)&#x000A;  <span class="ruby-identifier">atts</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">opts</span>&#x000A;  <span class="ruby-identifier">validates_each</span>(*<span class="ruby-identifier">atts</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">o</span>, <span class="ruby-identifier">a</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span>&#x000A;    <span class="ruby-identifier">o</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add</span>(<span class="ruby-identifier">a</span>, <span class="ruby-identifier">opts</span>[<span class="ruby-value">:message</span>]) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:with</span>]&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-validates_inclusion_of'>
                <a name='method-i-validates_inclusion_of'></a>
                <div class='synopsis'>
                  <span class='name'>validates_inclusion_of</span>
                  <span class='arguments'>(*atts)</span>
                </div>
                <div class='description'>
                  
                  <p>Validates that an attribute is within a specified range or set of values.</p>
                  
                  <p>Possible Options:</p>
                  <ul><li>
                  <p>:in - An array or range of values to check for validity (required)</p>
                  </li><li>
                  <p>:message - The message to use (default: ‘is not in range or set:
                  &lt;specified range&gt;’)</p>
                  </li></ul>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-validates_inclusion_of-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-validates_inclusion_of-source'><span class="ruby-comment"># File lib/sequel/plugins/validation_class_methods.rb, line 314</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">validates_inclusion_of</span>(*<span class="ruby-identifier">atts</span>)&#x000A;  <span class="ruby-identifier">opts</span> = <span class="ruby-identifier">extract_options!</span>(<span class="ruby-identifier">atts</span>)&#x000A;  <span class="ruby-identifier">n</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:in</span>]&#x000A;  <span class="ruby-keyword">unless</span> <span class="ruby-identifier">n</span> <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">n</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:cover?</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">n</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:include?</span>))&#x000A;    <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-string">&quot;The :in parameter is required, and must respond to cover? or include?&quot;</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-identifier">opts</span>[<span class="ruby-value">:message</span>] <span class="ruby-operator">||=</span> <span class="ruby-node">&quot;is not in range or set: #{n.inspect}&quot;</span>&#x000A;  <span class="ruby-identifier">reflect_validation</span>(<span class="ruby-value">:inclusion</span>, <span class="ruby-identifier">opts</span>, <span class="ruby-identifier">atts</span>)&#x000A;  <span class="ruby-identifier">atts</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">opts</span>&#x000A;  <span class="ruby-identifier">validates_each</span>(*<span class="ruby-identifier">atts</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">o</span>, <span class="ruby-identifier">a</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span>&#x000A;    <span class="ruby-identifier">o</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add</span>(<span class="ruby-identifier">a</span>, <span class="ruby-identifier">opts</span>[<span class="ruby-value">:message</span>]) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">n</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">n</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:cover?</span>) <span class="ruby-operator">?</span> <span class="ruby-value">:cover?</span> <span class="ruby-operator">:</span> <span class="ruby-value">:include?</span>, <span class="ruby-identifier">v</span>)&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-validates_length_of'>
                <a name='method-i-validates_length_of'></a>
                <div class='synopsis'>
                  <span class='name'>validates_length_of</span>
                  <span class='arguments'>(*atts)</span>
                </div>
                <div class='description'>
                  
                  <p>Validates the length of an attribute.</p>
                  
                  <p>Possible Options:</p>
                  <ul><li>
                  <p>:is - The exact size required for the value to be valid (no default)</p>
                  </li><li>
                  <p>:maximum - The maximum size allowed for the value (no default)</p>
                  </li><li>
                  <p>:message - The message to use (no default, overrides :nil_message,
                  :too_long, :too_short, and :wrong_length options if present)</p>
                  </li><li>
                  <p>:minimum - The minimum size allowed for the value (no default)</p>
                  </li><li>
                  <p>:nil_message - The message to use use if :maximum option is used and the
                  value is nil (default: ‘is not present’)</p>
                  </li><li>
                  <p>:too_long - The message to use use if it the value is too long (default:
                  ‘is too long’)</p>
                  </li><li>
                  <p>:too_short - The message to use use if it the value is too short (default:
                  ‘is too short’)</p>
                  </li><li>
                  <p>:within - The array/range that must include the size of the value for it to
                  be valid (no default)</p>
                  </li><li>
                  <p>:wrong_length - The message to use use if it the value is not valid
                  (default: ‘is the wrong length’)</p>
                  </li></ul>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-validates_length_of-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-validates_length_of-source'><span class="ruby-comment"># File lib/sequel/plugins/validation_class_methods.rb, line 240</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">validates_length_of</span>(*<span class="ruby-identifier">atts</span>)&#x000A;  <span class="ruby-identifier">opts</span> = {&#x000A;    <span class="ruby-value">:nil_message</span>  =<span class="ruby-operator">&gt;</span> <span class="ruby-string">'is not present'</span>,&#x000A;    <span class="ruby-value">:too_long</span>     =<span class="ruby-operator">&gt;</span> <span class="ruby-string">'is too long'</span>,&#x000A;    <span class="ruby-value">:too_short</span>    =<span class="ruby-operator">&gt;</span> <span class="ruby-string">'is too short'</span>,&#x000A;    <span class="ruby-value">:wrong_length</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">'is the wrong length'</span>&#x000A;  }.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">extract_options!</span>(<span class="ruby-identifier">atts</span>))&#x000A;  &#x000A;  <span class="ruby-identifier">opts</span>[<span class="ruby-value">:tag</span>] <span class="ruby-operator">||=</span> ([<span class="ruby-value">:length</span>] <span class="ruby-operator">+</span> [<span class="ruby-value">:maximum</span>, <span class="ruby-value">:minimum</span>, <span class="ruby-value">:is</span>, <span class="ruby-value">:within</span>].<span class="ruby-identifier">reject</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">x</span><span class="ruby-operator">|</span> <span class="ruby-operator">!</span><span class="ruby-identifier">opts</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">x</span>)}).<span class="ruby-identifier">join</span>(<span class="ruby-string">'-'</span>).<span class="ruby-identifier">to_sym</span>&#x000A;  <span class="ruby-identifier">reflect_validation</span>(<span class="ruby-value">:length</span>, <span class="ruby-identifier">opts</span>, <span class="ruby-identifier">atts</span>)&#x000A;  <span class="ruby-identifier">atts</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">opts</span>&#x000A;  <span class="ruby-identifier">validates_each</span>(*<span class="ruby-identifier">atts</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">o</span>, <span class="ruby-identifier">a</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span>&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-identifier">m</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:maximum</span>]&#x000A;      <span class="ruby-identifier">o</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add</span>(<span class="ruby-identifier">a</span>, <span class="ruby-identifier">opts</span>[<span class="ruby-value">:message</span>] <span class="ruby-operator">||</span> (<span class="ruby-identifier">v</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:too_long</span>] <span class="ruby-operator">:</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:nil_message</span>])) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">v</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-identifier">m</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-identifier">m</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:minimum</span>]&#x000A;      <span class="ruby-identifier">o</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add</span>(<span class="ruby-identifier">a</span>, <span class="ruby-identifier">opts</span>[<span class="ruby-value">:message</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:too_short</span>]) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">v</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-identifier">m</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-identifier">i</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:is</span>]&#x000A;      <span class="ruby-identifier">o</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add</span>(<span class="ruby-identifier">a</span>, <span class="ruby-identifier">opts</span>[<span class="ruby-value">:message</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:wrong_length</span>]) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">v</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">i</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-identifier">w</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:within</span>]&#x000A;      <span class="ruby-identifier">o</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add</span>(<span class="ruby-identifier">a</span>, <span class="ruby-identifier">opts</span>[<span class="ruby-value">:message</span>] <span class="ruby-operator">||</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:wrong_length</span>]) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">v</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">w</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">w</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:cover?</span>) <span class="ruby-operator">?</span> <span class="ruby-value">:cover?</span> <span class="ruby-operator">:</span> <span class="ruby-value">:include?</span>, <span class="ruby-identifier">v</span>.<span class="ruby-identifier">size</span>)&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-validates_numericality_of'>
                <a name='method-i-validates_numericality_of'></a>
                <div class='synopsis'>
                  <span class='name'>validates_numericality_of</span>
                  <span class='arguments'>(*atts)</span>
                </div>
                <div class='description'>
                  
                  <p>Validates whether an attribute is a number.</p>
                  
                  <p>Possible Options:</p>
                  <ul><li>
                  <p>:message - The message to use (default: ‘is not a number’)</p>
                  </li><li>
                  <p>:only_integer - Whether only integers are valid values (default: false)</p>
                  </li></ul>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-validates_numericality_of-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-validates_numericality_of-source'><span class="ruby-comment"># File lib/sequel/plugins/validation_class_methods.rb, line 272</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">validates_numericality_of</span>(*<span class="ruby-identifier">atts</span>)&#x000A;  <span class="ruby-identifier">opts</span> = {&#x000A;    <span class="ruby-value">:message</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">'is not a number'</span>,&#x000A;    <span class="ruby-value">:tag</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:numericality</span>,&#x000A;  }.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">extract_options!</span>(<span class="ruby-identifier">atts</span>))&#x000A;  <span class="ruby-identifier">reflect_validation</span>(<span class="ruby-value">:numericality</span>, <span class="ruby-identifier">opts</span>, <span class="ruby-identifier">atts</span>)&#x000A;  <span class="ruby-identifier">atts</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">opts</span>&#x000A;  <span class="ruby-identifier">validates_each</span>(*<span class="ruby-identifier">atts</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">o</span>, <span class="ruby-identifier">a</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span>&#x000A;    <span class="ruby-keyword">begin</span>&#x000A;      <span class="ruby-keyword">if</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:only_integer</span>]&#x000A;        <span class="ruby-constant">Kernel</span>.<span class="ruby-constant">Integer</span>(<span class="ruby-identifier">v</span>.<span class="ruby-identifier">to_s</span>)&#x000A;      <span class="ruby-keyword">else</span>&#x000A;        <span class="ruby-constant">Kernel</span>.<span class="ruby-constant">Float</span>(<span class="ruby-identifier">v</span>.<span class="ruby-identifier">to_s</span>)&#x000A;      <span class="ruby-keyword">end</span>&#x000A;    <span class="ruby-keyword">rescue</span>&#x000A;      <span class="ruby-identifier">o</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add</span>(<span class="ruby-identifier">a</span>, <span class="ruby-identifier">opts</span>[<span class="ruby-value">:message</span>])&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-validates_presence_of'>
                <a name='method-i-validates_presence_of'></a>
                <div class='synopsis'>
                  <span class='name'>validates_presence_of</span>
                  <span class='arguments'>(*atts)</span>
                </div>
                <div class='description'>
                  
                  <p>Validates the presence of an attribute.  Requires the value not be blank,
                  with false considered present instead of absent.</p>
                  
                  <p>Possible Options:</p>
                  <ul><li>
                  <p>:message - The message to use (default: ‘is not present’)</p>
                  </li></ul>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-validates_presence_of-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-validates_presence_of-source'><span class="ruby-comment"># File lib/sequel/plugins/validation_class_methods.rb, line 297</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">validates_presence_of</span>(*<span class="ruby-identifier">atts</span>)&#x000A;  <span class="ruby-identifier">opts</span> = {&#x000A;    <span class="ruby-value">:message</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">'is not present'</span>,&#x000A;    <span class="ruby-value">:tag</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:presence</span>,&#x000A;  }.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">extract_options!</span>(<span class="ruby-identifier">atts</span>))&#x000A;  <span class="ruby-identifier">reflect_validation</span>(<span class="ruby-value">:presence</span>, <span class="ruby-identifier">opts</span>, <span class="ruby-identifier">atts</span>)&#x000A;  <span class="ruby-identifier">atts</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">opts</span>&#x000A;  <span class="ruby-identifier">validates_each</span>(*<span class="ruby-identifier">atts</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">o</span>, <span class="ruby-identifier">a</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span>&#x000A;    <span class="ruby-identifier">o</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add</span>(<span class="ruby-identifier">a</span>, <span class="ruby-identifier">opts</span>[<span class="ruby-value">:message</span>]) <span class="ruby-keyword">if</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">blank?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">v</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword">false</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-validates_schema_type'>
                <a name='method-i-validates_schema_type'></a>
                <div class='synopsis'>
                  <span class='name'>validates_schema_type</span>
                  <span class='arguments'>(*atts)</span>
                </div>
                <div class='description'>
                  
                  <p>Validates whether an attribute has the correct ruby type for the associated
                  database type.  This is generally useful in conjunction with
                  raise_on_typecast_failure = false, to handle typecasting errors at
                  validation time instead of at setter time.</p>
                  
                  <p>Possible Options:</p>
                  <ul><li>
                  <p>:message - The message to use (default: ‘is not a valid
                  (integer|datetime|etc.)’)</p>
                  </li></ul>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-validates_schema_type-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-validates_schema_type-source'><span class="ruby-comment"># File lib/sequel/plugins/validation_class_methods.rb, line 335</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">validates_schema_type</span>(*<span class="ruby-identifier">atts</span>)&#x000A;  <span class="ruby-identifier">opts</span> = {&#x000A;    <span class="ruby-value">:tag</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:schema_type</span>,&#x000A;  }.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">extract_options!</span>(<span class="ruby-identifier">atts</span>))&#x000A;  <span class="ruby-identifier">reflect_validation</span>(<span class="ruby-value">:schema_type</span>, <span class="ruby-identifier">opts</span>, <span class="ruby-identifier">atts</span>)&#x000A;  <span class="ruby-identifier">atts</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">opts</span>&#x000A;  <span class="ruby-identifier">validates_each</span>(*<span class="ruby-identifier">atts</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">o</span>, <span class="ruby-identifier">a</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span>&#x000A;    <span class="ruby-keyword">next</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">nil?</span> <span class="ruby-operator">||</span> (<span class="ruby-identifier">klass</span> = <span class="ruby-identifier">o</span>.<span class="ruby-identifier">send</span>(<span class="ruby-value">:schema_type_class</span>, <span class="ruby-identifier">a</span>)).<span class="ruby-identifier">nil?</span>&#x000A;    <span class="ruby-keyword">if</span> <span class="ruby-identifier">klass</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>) <span class="ruby-operator">?</span> <span class="ruby-operator">!</span><span class="ruby-identifier">klass</span>.<span class="ruby-identifier">any?</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">kls</span><span class="ruby-operator">|</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-identifier">kls</span>)} <span class="ruby-operator">:</span> <span class="ruby-operator">!</span><span class="ruby-identifier">v</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-identifier">klass</span>)&#x000A;      <span class="ruby-identifier">message</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:message</span>] <span class="ruby-operator">||</span> <span class="ruby-node">&quot;is not a valid #{Array(klass).join(&quot; or &quot;).downcase}&quot;</span>&#x000A;      <span class="ruby-identifier">o</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add</span>(<span class="ruby-identifier">a</span>, <span class="ruby-identifier">message</span>)&#x000A;    <span class="ruby-keyword">end</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-validates_uniqueness_of'>
                <a name='method-i-validates_uniqueness_of'></a>
                <div class='synopsis'>
                  <span class='name'>validates_uniqueness_of</span>
                  <span class='arguments'>(*atts)</span>
                </div>
                <div class='description'>
                  
                  <p>Validates only if the fields in the model (specified by atts) are unique in
                  the database.  Pass an array of fields instead of multiple fields to
                  specify that the combination of fields must be unique, instead of that each
                  field should have a unique value.</p>
                  
                  <p>This means that the code:</p>
                  
                  <pre>validates_uniqueness_of([:column1, :column2])</pre>
                  
                  <p>validates the grouping of column1 and column2 while</p>
                  
                  <pre>validates_uniqueness_of(:column1, :column2)</pre>
                  
                  <p>validates them separately.</p>
                  
                  <p>You should also add a unique index in the database, as this suffers from a
                  fairly obvious race condition.</p>
                  
                  <p>Possible Options:</p>
                  <ul><li>
                  <p>:message - The message to use (default: ‘is already taken’)</p>
                  </li></ul>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-validates_uniqueness_of-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-validates_uniqueness_of-source'><span class="ruby-comment"># File lib/sequel/plugins/validation_class_methods.rb, line 366</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">validates_uniqueness_of</span>(*<span class="ruby-identifier">atts</span>)&#x000A;  <span class="ruby-identifier">opts</span> = {&#x000A;    <span class="ruby-value">:message</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-string">'is already taken'</span>,&#x000A;    <span class="ruby-value">:tag</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:uniqueness</span>,&#x000A;  }.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">extract_options!</span>(<span class="ruby-identifier">atts</span>))&#x000A;    &#x000A;  <span class="ruby-identifier">reflect_validation</span>(<span class="ruby-value">:uniqueness</span>, <span class="ruby-identifier">opts</span>, <span class="ruby-identifier">atts</span>)&#x000A;  <span class="ruby-identifier">atts</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">opts</span>&#x000A;  <span class="ruby-identifier">validates_each</span>(*<span class="ruby-identifier">atts</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">o</span>, <span class="ruby-identifier">a</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span>&#x000A;    <span class="ruby-identifier">error_field</span> = <span class="ruby-identifier">a</span>&#x000A;    <span class="ruby-identifier">a</span> = <span class="ruby-constant">Array</span>(<span class="ruby-identifier">a</span>)&#x000A;    <span class="ruby-identifier">v</span> = <span class="ruby-constant">Array</span>(<span class="ruby-identifier">v</span>)&#x000A;    <span class="ruby-keyword">next</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">v</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">||</span> <span class="ruby-operator">!</span><span class="ruby-identifier">v</span>.<span class="ruby-identifier">all?</span>&#x000A;    <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">o</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">filter</span>(<span class="ruby-identifier">a</span>.<span class="ruby-identifier">zip</span>(<span class="ruby-identifier">v</span>))&#x000A;    <span class="ruby-identifier">num_dups</span> = <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">count</span>&#x000A;    <span class="ruby-identifier">allow</span> = <span class="ruby-keyword">if</span> <span class="ruby-identifier">num_dups</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>&#x000A;      <span class="ruby-comment"># No unique value in the database</span>&#x000A;      <span class="ruby-keyword">true</span>&#x000A;    <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">num_dups</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">1</span>&#x000A;      <span class="ruby-comment"># Multiple &quot;unique&quot; values in the database!!</span>&#x000A;      <span class="ruby-comment"># Someone didn't add a unique index</span>&#x000A;      <span class="ruby-keyword">false</span>&#x000A;    <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">o</span>.<span class="ruby-identifier">new?</span>&#x000A;      <span class="ruby-comment"># New record, but unique value already exists in the database</span>&#x000A;      <span class="ruby-keyword">false</span>&#x000A;    <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">first</span> <span class="ruby-operator">===</span> <span class="ruby-identifier">o</span>&#x000A;      <span class="ruby-comment"># Unique value exists in database, but for the same record, so the update won't cause a duplicate record</span>&#x000A;      <span class="ruby-keyword">true</span>&#x000A;    <span class="ruby-keyword">else</span>&#x000A;      <span class="ruby-keyword">false</span>&#x000A;    <span class="ruby-keyword">end</span>&#x000A;    <span class="ruby-identifier">o</span>.<span class="ruby-identifier">errors</span>.<span class="ruby-identifier">add</span>(<span class="ruby-identifier">error_field</span>, <span class="ruby-identifier">opts</span>[<span class="ruby-value">:message</span>]) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">allow</span>&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div id='footer-push'></div>
    </div>
    <div id='footer'>
      <a target="docwin" href="http://github.com/mislav/hanna/tree/master"><strong>Hanna</strong> RDoc template</a>
    </div>
  </body>
</html>
