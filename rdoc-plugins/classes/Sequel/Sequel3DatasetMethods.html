<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang='en'>
  <head>
    <title>Sequel::Sequel3DatasetMethods</title>
    <meta content='text/html; charset=UTF-8' http-equiv='Content-Type'>
    <link href='../../css/style.css' media='screen' rel='stylesheet' type='text/css'>
    <script type='text/javascript'>
      //<![CDATA[
        function popupCode(url) {
          window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
        }
        
        function toggleCode(id) {
          var code = document.getElementById(id)
        
          code.style.display = code.style.display != 'block' ? 'block' : 'none'
          return true
        }
        
        // Make codeblocks hidden by default
        document.writeln('<' + 'style type="text/css">.method .source pre { display: none }<\/style>')
      //]]>
    </script>
  </head>
  <body class='page'>
    <div class='class' id='wrapper'>
      <div class='header'>
        <h1 class='name'>
          <span class='type'>module</span>
          Sequel::Sequel3DatasetMethods
        </h1>
        <ol class='paths'>
          <li>
            <a target="docwin" href="../../files/lib/sequel/extensions/sequel_3_dataset_methods_rb.html">lib/sequel/extensions/sequel_3_dataset_methods.rb</a>
          </li>
        </ol>
        <div class='parent'>
          Parent:
          <strong><a target="docwin" href="../Sequel.html">Sequel</a></strong>
        </div>
      </div>
      <div id='content'>
        <div id='text'>
          <div id='description'></div>
          <div id='method-list'>
            <h2>Methods</h2>
            <h3>Public Instance</h3>
            <ol>
              <li><a target="docwin" href="#method-i-5B-5D-3D">[]=</a></li>
              <li><a target="docwin" href="#attribute-i-db">db</a></li>
              <li><a target="docwin" href="#method-i-insert_multiple">insert_multiple</a></li>
              <li><a target="docwin" href="#attribute-i-opts">opts</a></li>
              <li><a target="docwin" href="#method-i-qualify_to">qualify_to</a></li>
              <li><a target="docwin" href="#method-i-qualify_to_first_source">qualify_to_first_source</a></li>
              <li><a target="docwin" href="#method-i-set">set</a></li>
              <li><a target="docwin" href="#method-i-to_csv">to_csv</a></li>
            </ol>
          </div>
          <div id='context'>
          </div>
          <div id='section'>
            <div id='constants-list'>
              <h2>Constants</h2>
              <div class='name-list'>
                <table summary='Constants'>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>COMMA</td>
                    <td>=</td>
                    <td class='context-item-value'>Dataset::COMMA</td>
                    <td>&nbsp;</td>
                    <td class='context-item-desc'></td>
                  </tr>
                </table>
              </div>
            </div>
            <div id='attribute-list'>
              <h2 class='section-bar'>Attributes</h2>
              <div class='name-list'>
                <table>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>
                      <a name='attribute-i-db'>db</a>
                    </td>
                    <td class='context-item-value'>[W]</td>
                    <td class='context-item-desc'>
                      
                      <p>The database related to this dataset.  This is the <a
                      href="Database.html">Database</a> instance that will execute all of this
                      datasetâ€™s queries.</p>
                    </td>
                  </tr>
                  <tr class='top-aligned-row context-row'>
                    <td class='context-item-name'>
                      <a name='attribute-i-opts'>opts</a>
                    </td>
                    <td class='context-item-value'>[W]</td>
                    <td class='context-item-desc'>
                      
                      <p>The hash of options for this dataset, keys are symbols.</p>
                    </td>
                  </tr>
                </table>
              </div>
            </div>
            <div id='methods'>
              <h2>Public Instance methods</h2>
              <div class='method public-instance' id='method-method-i-5B-5D-3D'>
                <a name='method-i-5B-5D-3D'></a>
                <div class='synopsis'>
                  <span class='name'>[]=</span>
                  <span class='arguments'>(conditions, values)</span>
                </div>
                <div class='description'>
                  
                  <p>Update all records matching the conditions with the values specified.
                  Returns the number of rows affected.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>][:<span class="ruby-identifier">id=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">1</span>] = {:<span class="ruby-identifier">id=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">2</span>} <span class="ruby-comment"># UPDATE table SET id = 2 WHERE id = 1</span>&#x000A;<span class="ruby-comment"># =&gt; 1 # number of rows affected</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-5B-5D-3D-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-5B-5D-3D-source'><span class="ruby-comment"># File lib/sequel/extensions/sequel_3_dataset_methods.rb, line 37</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-operator">[]=</span>(<span class="ruby-identifier">conditions</span>, <span class="ruby-identifier">values</span>)&#x000A;  <span class="ruby-identifier">filter</span>(<span class="ruby-identifier">conditions</span>).<span class="ruby-identifier">update</span>(<span class="ruby-identifier">values</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-insert_multiple'>
                <a name='method-i-insert_multiple'></a>
                <div class='synopsis'>
                  <span class='name'>insert_multiple</span>
                  <span class='arguments'>(array, &block)</span>
                </div>
                <div class='description'>
                  
                  <p>Inserts multiple values. If a block is given it is invoked for each item in
                  the given array before inserting it.  See <code>multi_insert</code> as a
                  possibly faster version that may be able to insert multiple records in one
                  <a href="SQL.html">SQL</a> statement (if supported by the database).
                  Returns an array of primary keys of inserted rows.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">insert_multiple</span>([{:<span class="ruby-identifier">x=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">1</span>}, {:<span class="ruby-identifier">x=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">2</span>}])&#x000A;<span class="ruby-comment"># =&gt; [4, 5]</span>&#x000A;<span class="ruby-comment"># INSERT INTO table (x) VALUES (1)</span>&#x000A;<span class="ruby-comment"># INSERT INTO table (x) VALUES (2)</span>&#x000A;&#x000A;<span class="ruby-constant">DB</span>[:<span class="ruby-identifier">table</span>].<span class="ruby-identifier">insert_multiple</span>([{:<span class="ruby-identifier">x=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">1</span>}, {:<span class="ruby-identifier">x=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">2</span>}]){<span class="ruby-operator">|</span><span class="ruby-identifier">row</span><span class="ruby-operator">|</span> <span class="ruby-identifier">row</span>[:<span class="ruby-identifier">y</span>] = <span class="ruby-identifier">row</span>[:<span class="ruby-identifier">x</span>] * <span class="ruby-value">2</span>; <span class="ruby-identifier">row</span> }&#x000A;<span class="ruby-comment"># =&gt; [6, 7]</span>&#x000A;<span class="ruby-comment"># INSERT INTO table (x, y) VALUES (1, 2)</span>&#x000A;<span class="ruby-comment"># INSERT INTO table (x, y) VALUES (2, 4)</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-insert_multiple-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-insert_multiple-source'><span class="ruby-comment"># File lib/sequel/extensions/sequel_3_dataset_methods.rb, line 56</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">insert_multiple</span>(<span class="ruby-identifier">array</span>, &amp;<span class="ruby-identifier">block</span>)&#x000A;  <span class="ruby-keyword">if</span> <span class="ruby-identifier">block</span>&#x000A;    <span class="ruby-identifier">array</span>.<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">i</span><span class="ruby-operator">|</span> <span class="ruby-identifier">insert</span>(<span class="ruby-identifier">block</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">i</span>))}&#x000A;  <span class="ruby-keyword">else</span>&#x000A;    <span class="ruby-identifier">array</span>.<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">i</span><span class="ruby-operator">|</span> <span class="ruby-identifier">insert</span>(<span class="ruby-identifier">i</span>)}&#x000A;  <span class="ruby-keyword">end</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-qualify_to'>
                <a name='method-i-qualify_to'></a>
                <div class='synopsis'>
                  <span class='name'>qualify_to</span>
                  <span class='arguments'>(table)</span>
                </div>
                <div class='description'>
                  
                  <p>Return a copy of the dataset with unqualified identifiers in the SELECT,
                  WHERE, GROUP, HAVING, and ORDER clauses qualified by the given table. If no
                  columns are currently selected, select all columns of the given table.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">filter</span>(:<span class="ruby-identifier">id=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">1</span>).<span class="ruby-identifier">qualify_to</span>(:<span class="ruby-identifier">i</span>)&#x000A;<span class="ruby-comment"># SELECT i.* FROM items WHERE (i.id = 1)</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-qualify_to-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-qualify_to-source'><span class="ruby-comment"># File lib/sequel/extensions/sequel_3_dataset_methods.rb, line 71</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">qualify_to</span>(<span class="ruby-identifier">table</span>)&#x000A;  <span class="ruby-identifier">qualify</span>(<span class="ruby-identifier">table</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-qualify_to_first_source'>
                <a name='method-i-qualify_to_first_source'></a>
                <div class='synopsis'>
                  <span class='name'>qualify_to_first_source</span>
                  <span class='arguments'>()</span>
                </div>
                <div class='description'>
                  
                  <p>Qualify the dataset to its current first source.  This is useful if you
                  have unqualified identifiers in the query that all refer to the first
                  source, and you want to join to another table which has columns with the
                  same name as columns in the current dataset. See <code>qualify_to</code>.</p>
                  
                  <pre class="ruby"><span class="ruby-constant">DB</span>[:<span class="ruby-identifier">items</span>].<span class="ruby-identifier">filter</span>(:<span class="ruby-identifier">id=</span><span class="ruby-operator">&gt;</span><span class="ruby-value">1</span>).<span class="ruby-identifier">qualify_to_first_source</span>&#x000A;<span class="ruby-comment"># SELECT items.* FROM items WHERE (items.id = 1)</span></pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-qualify_to_first_source-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-qualify_to_first_source-source'><span class="ruby-comment"># File lib/sequel/extensions/sequel_3_dataset_methods.rb, line 83</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">qualify_to_first_source</span>&#x000A;  <span class="ruby-identifier">qualify</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-set'>
                <a name='method-i-set'></a>
                <div class='synopsis'>
                  <span class='name'>set</span>
                  <span class='arguments'>(*args)</span>
                </div>
                <div class='description'>
                  
                  <p>Alias for update, but not aliased directly so subclasses donâ€™t have to
                  override both methods.</p>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-set-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-set-source'><span class="ruby-comment"># File lib/sequel/extensions/sequel_3_dataset_methods.rb, line 89</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">set</span>(*<span class="ruby-identifier">args</span>)&#x000A;  <span class="ruby-identifier">update</span>(*<span class="ruby-identifier">args</span>)&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
              <div class='method public-instance' id='method-method-i-to_csv'>
                <a name='method-i-to_csv'></a>
                <div class='synopsis'>
                  <span class='name'>to_csv</span>
                  <span class='arguments'>(include_column_titles = true)</span>
                </div>
                <div class='description'>
                  
                  <p>Returns a string in CSV format containing the dataset records. By  default
                  the CSV representation includes the column titles in the first line. You
                  can turn that off by passing false as the  include_column_titles argument.</p>
                  
                  <p>This does not use a CSV library or handle quoting of values in any way.  If
                  any values in any of the rows could include commas or line endings, you
                  shouldnâ€™t use this.</p>
                  
                  <pre>puts DB[:table].to_csv # SELECT * FROM table&#x000A;# id,name&#x000A;# 1,Jim&#x000A;# 2,Bob</pre>
                </div>
                <div class='source'>
                  <a class='source-toggle' href='#' onclick="toggleCode('method-i-to_csv-source'); return false">
                    [show source]
                  </a>
                  <pre id='method-i-to_csv-source'><span class="ruby-comment"># File lib/sequel/extensions/sequel_3_dataset_methods.rb, line 106</span>&#x000A;<span class="ruby-keyword">def</span> <span class="ruby-identifier">to_csv</span>(<span class="ruby-identifier">include_column_titles</span> = <span class="ruby-keyword">true</span>)&#x000A;  <span class="ruby-identifier">n</span> = <span class="ruby-identifier">naked</span>&#x000A;  <span class="ruby-identifier">cols</span> = <span class="ruby-identifier">n</span>.<span class="ruby-identifier">columns</span>&#x000A;  <span class="ruby-identifier">csv</span> = <span class="ruby-string">''</span>&#x000A;  <span class="ruby-identifier">csv</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;#{cols.join(COMMA)}\r\n&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">include_column_titles</span>&#x000A;  <span class="ruby-identifier">n</span>.<span class="ruby-identifier">each</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span> <span class="ruby-identifier">csv</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;#{cols.collect{|c| r[c]}.join(COMMA)}\r\n&quot;</span>}&#x000A;  <span class="ruby-identifier">csv</span>&#x000A;<span class="ruby-keyword">end</span></pre>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div id='footer-push'></div>
    </div>
    <div id='footer'>
      <a target="docwin" href="http://github.com/mislav/hanna/tree/master"><strong>Hanna</strong> RDoc template</a>
    </div>
  </body>
</html>
